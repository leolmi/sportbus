<div class="page-editor shuttle">
  @if (manager.dayHasCalendarItems$|async) {
    @if (manager.isLoadingSod$|async) {
      <div class="empty-container">loading...</div>
    } @else {
      <!-- chi c'Ã¨ -->
      <div class="persons-list">
        @if (athletesMap$|async; as atlMap) {
          @for (atl of athletes$|async; track $index) {
            <div class="person-selector"
                 fxLayout="row" fxLayoutAlign="start center"
                 (click)="toggleAthlete(atl)"
                 [class.present]="atlMap[atl.code]==='p'"
                 [class.absent]="atlMap[atl.code]==='a'"
                 [class.unknown]="!atlMap[atl.code]">
              <span class="text">{{atl.name}}</span>
              <mat-icon>{{ICON_BY_CODE[atlMap[atl.code]]||UNKNOWN_ICON}}</mat-icon>
              @if (atl.group) {
                <div class="athlete-group">{{atl.group|groupName:manager.session}}</div>
              }
            </div>
          }
        }
      </div>
      <!-- calendario -->
      <div class="calendar">
        @for (item of calendar$|async; track $index) {
          <div class="calendar-item"
               fxLayout="row" fxLayoutAlign="start center">
            <span class="item-group" fxFlex>{{item.group}}</span>
            <span class="item-target" fxFlex>{{item.target}}</span>
            <span class="item-time item-start">{{item.start}}</span>
            <span class="item-time item-end">{{item.end}}</span>
          </div>
        }
      </div>
      <!-- navette necessarie A/R -> chi li porta -->
      <div class="shuttles">
        <div class="shuttles-header"
             fxLayout="row" fxLayoutAlign="start center">
          <span fxFlex>A</span>
          <span fxFlex>R</span>
        </div>
        <div class="shuttles-container" fxLayout="row">
          <div class="shuttles-column" fxLayout="column" fxFlex>
            @for (shA of shuttles$|async|shuttleType:'A'; track $index) {
              <shuttle-editor [shuttle]="shA"></shuttle-editor>
            }
            <shuttle-errors direction="A"></shuttle-errors>
          </div>
          <div class="shuttles-column" fxLayout="column" fxFlex>
            @for (shR of shuttles$|async|shuttleType:'R'; track $index) {
              <shuttle-editor [shuttle]="shR"></shuttle-editor>
            }
            <shuttle-errors direction="R"></shuttle-errors>
          </div>
        </div>
      </div>
    }
  } @else if (manager.isEmpty$|async) {
    <div class="empty-container click-content" (click)="goToConfiguration()">configure session...</div>
  } @else {
    <div class="empty-container">no shuttle on this day</div>
  }
</div>
